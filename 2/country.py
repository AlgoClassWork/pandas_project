import pandas as pd

# === 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö ===
df = pd.read_csv("countries.csv")
df = df.applymap(lambda x: str(x).replace(',', '.') if isinstance(x, str) else x)

cols_to_num = [
    'Population','Area (sq. mi.)','Pop. Density (per sq. mi.)','Coastline (coast/area ratio)',
    'Net migration','Infant mortality (per 1000 births)','GDP ($ per capita)','Literacy (%)',
    'Phones (per 1000)','Arable (%)','Crops (%)','Other (%)','Climate','Birthrate','Deathrate',
    'Agriculture','Industry','Service'
]
df[cols_to_num] = df[cols_to_num].apply(pd.to_numeric, errors='coerce')
df = df.fillna(df.mean(numeric_only=True))
df = df.dropna(subset=["Country", "Region"])

print("\n‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω—ã! –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑.\n")

# === 2. –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ===
def interpret_corr(value):
    if pd.isna(value):
        return "–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö"
    if abs(value) < 0.2:
        strength = "–æ—á–µ–Ω—å —Å–ª–∞–±–∞—è"
    elif abs(value) < 0.4:
        strength = "—Å–ª–∞–±–∞—è"
    elif abs(value) < 0.7:
        strength = "—É–º–µ—Ä–µ–Ω–Ω–∞—è"
    else:
        strength = "—Å–∏–ª—å–Ω–∞—è"
    direction = "–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è" if value > 0 else "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è"
    return f"{strength} {direction} —Å–≤—è–∑—å (r={value:.3f})"

# === 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑ ===
print("=== –ê–ù–ê–õ–ò–ó –ì–ò–ü–û–¢–ï–ó ===\n")

# 1Ô∏è‚É£
corr1 = df['Pop. Density (per sq. mi.)'].corr(df['GDP ($ per capita)'])
print(f"1Ô∏è‚É£ –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è –∏ –í–í–ü ‚Üí {interpret_corr(corr1)}")
print("–í—ã–≤–æ–¥: —á–µ–º –≤—ã—à–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è, —Ç–µ–º –í–í–ü, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω–µ–º–Ω–æ–≥–æ –Ω–∏–∂–µ.\n")

# 2Ô∏è‚É£
mean_gdp_pos = df[df['Net migration'] > 0]['GDP ($ per capita)'].mean()
mean_gdp_neg = df[df['Net migration'] < 0]['GDP ($ per capita)'].mean()
print(f"2Ô∏è‚É£ –°—Ä–µ–¥–Ω–∏–π –í–í–ü –ø—Ä–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏: {mean_gdp_pos:.2f}")
print(f"   –°—Ä–µ–¥–Ω–∏–π –í–í–ü –ø—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏: {mean_gdp_neg:.2f}")
print("–í—ã–≤–æ–¥: —Å—Ç—Ä–∞–Ω—ã —Å –ø—Ä–∏—Ç–æ–∫–æ–º –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–≥–∞—á–µ.\n")

# 3Ô∏è‚É£
corr2 = df['Literacy (%)'].corr(df['Infant mortality (per 1000 births)'])
print(f"3Ô∏è‚É£ –ì—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å –∏ –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å ‚Üí {interpret_corr(corr2)}")
print("–í—ã–≤–æ–¥: —á–µ–º –≤—ã—à–µ –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å, —Ç–µ–º –Ω–∏–∂–µ –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å.\n")

# 4Ô∏è‚É£
corr3 = df['Agriculture'].corr(df['GDP ($ per capita)'])
print(f"4Ô∏è‚É£ –°–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ –∏ –í–í–ü ‚Üí {interpret_corr(corr3)}")
print("–í—ã–≤–æ–¥: —Å—Ç—Ä–∞–Ω—ã —Å –≤—ã—Å–æ–∫–æ–π –¥–æ–ª–µ–π —Å–µ–ª—å—Å–∫–æ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞ –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π –í–í–ü.\n")

# 5Ô∏è‚É£
corr4 = df['Phones (per 1000)'].corr(df['Literacy (%)'])
print(f"5Ô∏è‚É£ –¢–µ–ª–µ—Ñ–æ–Ω—ã –∏ –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å ‚Üí {interpret_corr(corr4)}")
print("–í—ã–≤–æ–¥: –Ω–∞–ª–∏—á–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞–Ω–æ —Å —É—Ä–æ–≤–Ω–µ–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º.\n")

# 6Ô∏è‚É£
high_lit = df[df['Literacy (%)'] > 90]['GDP ($ per capita)'].mean()
low_lit = df[df['Literacy (%)'] <= 90]['GDP ($ per capita)'].mean()
print(f"6Ô∏è‚É£ –°—Ä–µ–¥–Ω–∏–π –í–í–ü –ø—Ä–∏ –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏ >90%: {high_lit:.2f}")
print(f"   –°—Ä–µ–¥–Ω–∏–π –í–í–ü –ø—Ä–∏ –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏ <=90%: {low_lit:.2f}")
print("–í—ã–≤–æ–¥: –≤—ã—Å–æ–∫–∞—è –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –í–í–ü.\n")

# 7Ô∏è‚É£
corr5 = df['GDP ($ per capita)'].corr(df['Infant mortality (per 1000 births)'])
print(f"7Ô∏è‚É£ –í–í–ü –∏ –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å ‚Üí {interpret_corr(corr5)}")
print("–í—ã–≤–æ–¥: —á–µ–º –≤—ã—à–µ –í–í–ü, —Ç–µ–º –Ω–∏–∂–µ –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å.\n")

# 8Ô∏è‚É£
df['Coastal'] = df['Coastline (coast/area ratio)'].apply(lambda x: 1 if x > 0 else 0)
gdp_coast = df.groupby('Coastal')['GDP ($ per capita)'].mean()
print("8Ô∏è‚É£ –°—Ä–µ–¥–Ω–∏–π –í–í–ü –ø–æ –Ω–∞–ª–∏—á–∏—é –≤—ã—Ö–æ–¥–∞ –∫ –º–æ—Ä—é:")
print(gdp_coast)
print("–í—ã–≤–æ–¥: —Å—Ç—Ä–∞–Ω—ã —Å –≤—ã—Ö–æ–¥–æ–º –∫ –º–æ—Ä—é –∏–º–µ—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤ —ç–∫–æ–Ω–æ–º–∏–∫–µ –∑–∞ —Å—á—ë—Ç —Ç–æ—Ä–≥–æ–≤–ª–∏.\n")

# 9Ô∏è‚É£
climate_mortality = df.groupby('Climate')['Infant mortality (per 1000 births)'].mean().sort_index()
print("9Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å –ø–æ –∫–ª–∏–º–∞—Ç—É:\n", climate_mortality)
print("–í—ã–≤–æ–¥: –≤ –∂–∞—Ä–∫–æ–º –∫–ª–∏–º–∞—Ç–µ –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å –æ–±—ã—á–Ω–æ –≤—ã—à–µ.\n")

# üîü
corr6 = df['Arable (%)'].corr(df['Agriculture'])
print(f"üîü –ü–∞—Ö–æ—Ç–Ω—ã–µ –∑–µ–º–ª–∏ –∏ —Å–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ ‚Üí {interpret_corr(corr6)}")
print("–í—ã–≤–æ–¥: –ª–æ–≥–∏—á–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è —Å–≤—è–∑—å ‚Äî –±–æ–ª—å—à–µ –ø–∞—Ö–æ—Ç–Ω—ã—Ö –∑–µ–º–µ–ª—å, –≤—ã—à–µ –¥–æ–ª—è —Å–µ–ª—å—Å–∫–æ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞.\n")

# 11Ô∏è‚É£
corr7 = df['Service'].corr(df['GDP ($ per capita)'])
print(f"11Ô∏è‚É£ –°—Ñ–µ—Ä–∞ —É—Å–ª—É–≥ –∏ –í–í–ü ‚Üí {interpret_corr(corr7)}")
print("–í—ã–≤–æ–¥: —Ä–∞–∑–≤–∏—Ç–∞—è —Å—Ñ–µ—Ä–∞ —É—Å–ª—É–≥ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Ä–æ—Å—Ç—É –í–í–ü.\n")

# 12Ô∏è‚É£
corr8 = df['Industry'].corr(df['GDP ($ per capita)'])
print(f"12Ô∏è‚É£ –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å –∏ –í–í–ü ‚Üí {interpret_corr(corr8)}")
print("–í—ã–≤–æ–¥: –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å ‚Äî –∫–ª—é—á–µ–≤–æ–π —Ñ–∞–∫—Ç–æ—Ä —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è.\n")

# 13Ô∏è‚É£
corr9 = df['GDP ($ per capita)'].corr(df['Birthrate'])
corr10 = df['GDP ($ per capita)'].corr(df['Deathrate'])
print(f"13Ô∏è‚É£ –í–í–ü –∏ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç—å ‚Üí {interpret_corr(corr9)}")
print(f"    –í–í–ü –∏ —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å ‚Üí {interpret_corr(corr10)}")
print("–í—ã–≤–æ–¥: –±–æ–≥–∞—Ç—ã–µ —Å—Ç—Ä–∞–Ω—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—Ç—Å—è –Ω–∏–∑–∫–æ–π —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç—å—é –∏ —É–º–µ—Ä–µ–Ω–Ω–æ–π —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å—é.\n")

# 14Ô∏è‚É£
eu = df[df['Region'] == 'WESTERN EUROPE']
mean_gdp_eu = eu['GDP ($ per capita)'].mean()
mean_lit_eu = eu['Literacy (%)'].mean()
mean_gdp_all = df['GDP ($ per capita)'].mean()
mean_lit_all = df['Literacy (%)'].mean()
print(f"14Ô∏è‚É£ –°—Ä–µ–¥–Ω–∏–π –í–í–ü –≤ –ó–∞–ø–∞–¥–Ω–æ–π –ï–≤—Ä–æ–ø–µ: {mean_gdp_eu:.2f} (—Å—Ä–µ–¥–Ω–∏–π –ø–æ –º–∏—Ä—É: {mean_gdp_all:.2f})")
print(f"    –°—Ä–µ–¥–Ω—è—è –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å –≤ –ó–∞–ø–∞–¥–Ω–æ–π –ï–≤—Ä–æ–ø–µ: {mean_lit_eu:.2f} (–º–∏—Ä–æ–≤–∞—è: {mean_lit_all:.2f})")
print("–í—ã–≤–æ–¥: –ó–∞–ø–∞–¥–Ω–∞—è –ï–≤—Ä–æ–ø–∞ ‚Äî —Ä–µ–≥–∏–æ–Ω —Å —Å–∞–º—ã–º–∏ –≤—ã—Å–æ–∫–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –∂–∏–∑–Ω–∏ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.\n")

# 15Ô∏è‚É£
df['Migration_positive'] = df['Net migration'] > 0
mortality_migration = df.groupby('Migration_positive')['Infant mortality (per 1000 births)'].mean()
print("15Ô∏è‚É£ –°—Ä–µ–¥–Ω—è—è –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–∞—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–∑–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:")
print(mortality_migration)
print("–í—ã–≤–æ–¥: —Å—Ç—Ä–∞–Ω—ã, –∫—É–¥–∞ –ø—Ä–∏–µ–∑–∂–∞—é—Ç –º–∏–≥—Ä–∞–Ω—Ç—ã, –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –ª—É—á—à–∏–π —É—Ä–æ–≤–µ–Ω—å –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.\n")

print("‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ 15 –≥–∏–ø–æ—Ç–µ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
